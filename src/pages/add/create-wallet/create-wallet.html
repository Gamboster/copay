<wide-header-page title="{{ 'Create {coinLabel} Wallet' | translate: {coinLabel: coin.toUpperCase()} }}">
  <ion-buttons right>
    <button clear wide-header-bar-button (click)="setOptsAndCreate()" [disabled]="!createForm.valid" ion-button>
      <span translate>Create</span>
    </button>
  </ion-buttons>
  <div page-content>
    <button class="linked-wallet" *ngIf="coin === 'eth'" ion-item (click)="showPairedWalletSelector()">
      <ion-label>
        <div class="summary-item">
          <span translate>Linked to</span>
        </div>
      </ion-label>

      <ion-note item-end>
        <ion-row align-items-center class="wallet" *ngIf="pairedWallet">
          <ion-col>
            <coin-icon [coin]="pairedWallet.coin" [network]="pairedWallet.network"></coin-icon>
          </ion-col>

          <ion-col>
            <span class="note-container ellipsis">{{pairedWallet.name}}</span>
          </ion-col>
        </ion-row>

        <ion-row align-items-center class="wallet" *ngIf="!pairedWallet">
          <div translate>Select a wallet to link to</div>
          <div class="last-item" item-end>
            <button ion-button clear color="grey" icon-only>
              <ion-icon *ngIf="!isOpenSelector" name="ios-arrow-down-outline"></ion-icon>
              <ion-icon *ngIf="isOpenSelector" name="ios-arrow-up-outline"></ion-icon>
            </button>
          </div>
        </ion-row>
      </ion-note>
    </button>

    <form [formGroup]="createForm">
      <ion-item>
        <ion-label floating>{{'Wallet name' | translate}}</ion-label>
        <ion-input type="text" formControlName="walletName"></ion-input>
      </ion-item>

      <div *ngIf="isShared">
        <ion-item>
          <ion-label floating>{{'Your name' | translate}}</ion-label>
          <ion-input type="text" formControlName="myName"></ion-input>
        </ion-item>

        <div class="multisig-input" *ngIf="coin === 'eth'">
          <ion-item class="search-wrapper" [ngClass]="{'invalid': invalidAddress && createForm.value.search != ''}">
            <ion-input placeholder="{{'Enter {coinName} address' | translate: {coinName: coin.toUpperCase()} }}" formControlName="search" (ionChange)="processInput(createForm.value.search)"></ion-input>
            <ion-icon *ngIf="invalidAddress && createForm.value.search != ''" item-end class="backspace-icon" name="backspace" (click)="cleanSearch()"></ion-icon>
            <ion-icon item-end class="scan-icon" (click)="openScanner()">
              <img src="assets/img/scan-ico.svg">
            </ion-icon>
          </ion-item>
        </div>
        <button *ngIf="!invalidAddress && createForm.value.search != ''" clear (click)="addAddress()" ion-button>
          {{'Add Address' | translate}}
        </button>

        <div *ngIf="coin === 'eth'">
          <!-- <div *ngFor="let addr of multisigAddresses; let idx = index">
            <span>{{idx+1}} - {{addr}}</span>
          </div> -->
          <ion-item-divider class="item-divider-header" *ngFor="let addr of multisigAddresses; let idx = index">
            <span class="ellipsis">{{idx+1}} - {{addr}}</span>
            <ion-icon *ngIf="idx != 0" class="close-icon pointer" name="ios-close-outline" item-right (click)="removeAddress(idx)"></ion-icon>
          </ion-item-divider>
        </div>

        <div class="custom-item">
          <div class="label">{{'Required number of signatures' | translate}}</div>
          <div class="buttons-container">
            <button clear class="remove-button" (click)="this.coin === 'eth' ? setEthMultisigRequiredCopayers('remove') : set('requiredCopayers', this.createForm.value.requiredCopayers - 1)" ion-button>
              <ion-icon name="remove"></ion-icon>
            </button>
            <button clear class="add-button" (click)="this.coin === 'eth' ? setEthMultisigRequiredCopayers('add') : set('requiredCopayers', this.createForm.value.requiredCopayers + 1)" ion-button>
              {{createForm.value.requiredCopayers}}
            </button>
          </div>
        </div>

        <div class="custom-item">
          <div class="label">{{'Total number of copayers' | translate}}</div>
          <div *ngIf="coin !== 'eth'" class="buttons-container">
            <button clear class="remove-button" (click)="set('totalCopayers', this.createForm.value.totalCopayers - 1)" ion-button>
              <ion-icon name="remove"></ion-icon>
            </button>
            <button clear class="add-button" (click)="set('totalCopayers',this.createForm.value.totalCopayers + 1)" ion-button>
              {{createForm.value.totalCopayers}}
            </button>
          </div>
          <div *ngIf="coin === 'eth'" class="buttons-container">
            <button clear class="add-button" ion-button>
              {{createForm.value.totalCopayers}}
            </button>
          </div>
        </div>

        <label-tip type="info" header="no-header" class="no-arrowhead">
          <div label-tip-body>
            <span translate>Multi-user wallet require multiple devices to setup. It takes longer to complete but it's recommended security configuration for long term storage.</span>
          </div>
        </label-tip>
      </div>

      <button ion-button class="button-standard button-secondary" (click)="showAdvOpts = !showAdvOpts">
        <span *ngIf="!showAdvOpts">{{'Show advanced options' | translate}}</span>
        <span *ngIf="showAdvOpts">{{'Hide advanced options' | translate}}</span>
      </button>

      <div *ngIf="showAdvOpts" padding-bottom>
        <ion-item>
          <ion-label stacked>Wallet Service URL</ion-label>
          <ion-input type="text" formControlName="bwsURL"></ion-input>
        </ion-item>

        <ion-item *ngIf="!keyId">
          <ion-label stacked>{{'Wallet key' | translate}}</ion-label>
          <ion-select okText="{{okText}}" cancelText="{{cancelText}}" formControlName="selectedSeed" (ionChange)="seedOptionsChange(createForm.value.selectedSeed)">
            <ion-option *ngFor="let opt of seedOptions" [value]="opt.id">{{opt.label}}</ion-option>
          </ion-select>
        </ion-item>

        <ion-item *ngIf="createForm.value.selectedSeed == 'set' && !keyId">
          <ion-label stacked>{{'Wallet recovery phrase' | translate}}</ion-label>
          <ion-input type="text" formControlName="recoveryPhrase"></ion-input>
        </ion-item>

        <ion-item [ngClass]="{'with-label': createForm.value.testnetEnabled}" *ngIf="createForm.value.selectedSeed == 'new'">
          <ion-label><span *ngIf="coin === 'eth'">Kovan </span>Testnet</ion-label>
          <ion-toggle formControlName="testnetEnabled" (ionChange)="setDerivationPath()" [disabled]="isShared && coin == 'eth'"></ion-toggle>
        </ion-item>

        <label-tip *ngIf="createForm.value.testnetEnabled && createForm.value.selectedSeed == 'new'" type="warn">
          <span label-tip-title translate>Testnet Wallet</span>
          <div label-tip-body>
            {{ 'The testnet is an alternative {coinName} block chain, to be used for testing. Testnet coins are separate and distinct from actual {coinName}, and do not have any value. This allows application developers or {coinName} testers to experiment, without having to use real {coinName}' | translate : {coinName: coinName } }} .
          </div>
        </label-tip>

        <ion-item *ngIf="createForm.value.selectedSeed == 'set' && !keyId">
          <ion-label stacked>{{'Derivation path' | translate}}</ion-label>
          <ion-input type="text" formControlName="derivationPath"></ion-input>
        </ion-item>

        <ion-item [ngClass]="{'with-label': createForm.value.useNativeSegwit}" *ngIf="coin === 'btc' && createForm.value.selectedSeed == 'new'">
          <ion-label>Segwit</ion-label>
          <ion-toggle formControlName="useNativeSegwit"></ion-toggle>
        </ion-item>

        <ion-item *ngIf="!isSingleAddress()" [ngClass]="{'with-label': createForm.value.singleAddress}">
          <ion-label>{{'Single address' | translate}}</ion-label>
          <ion-toggle formControlName="singleAddress"></ion-toggle>
        </ion-item>
        <label-tip *ngIf="createForm.value.singleAddress" type="info" header="no-header">
          <div label-tip-body>
            <span translate>The single address feature will force the wallet to only use one address rather than generating new addresses.</span>
            <br>
            <a class="label-tip-link" (click)="openSupportSingleAddress()" translate>Learn More</a>
          </div>
        </label-tip>
      </div>
    </form>
  </div>
</wide-header-page>